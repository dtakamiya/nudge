generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Member {
  id         String   @id @default(uuid())
  name       String
  department String?
  position   String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  meetings    Meeting[]
  actionItems ActionItem[]
}

model Meeting {
  id        String   @id @default(uuid())
  memberId  String
  date      DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  member      Member       @relation(fields: [memberId], references: [id], onDelete: Cascade)
  topics      Topic[]
  actionItems ActionItem[]

  @@index([memberId])
}

model Topic {
  id        String        @id @default(uuid())
  meetingId String
  category  TopicCategory
  title     String
  notes     String        @default("")
  sortOrder Int           @default(0)
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt

  meeting Meeting @relation(fields: [meetingId], references: [id], onDelete: Cascade)

  @@index([meetingId])
}

enum TopicCategory {
  WORK_PROGRESS
  CAREER
  ISSUES
  FEEDBACK
  OTHER
}

model ActionItem {
  id          String           @id @default(uuid())
  meetingId   String
  memberId    String
  title       String
  description String           @default("")
  status      ActionItemStatus @default(TODO)
  dueDate     DateTime?
  completedAt DateTime?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  meeting Meeting @relation(fields: [meetingId], references: [id], onDelete: Cascade)
  member  Member  @relation(fields: [memberId], references: [id], onDelete: Cascade)

  @@index([meetingId])
  @@index([memberId])
  @@index([status])
}

enum ActionItemStatus {
  TODO
  IN_PROGRESS
  DONE
}
